{
	"name": "DIMFacilityView",
	"properties": {
		"content": {
			"query": "SELECT\n    'eCase' AS [SystemSource],\n    f.ID AS [FacilityID],\n    f.FacilityCode,\n    f.FacilityName,\n    CASE\n        WHEN f.FacilityName LIKE '%Acacia Court%' THEN 'Acacia Court'\n        WHEN f.FacilityName LIKE '%Allambi%' THEN 'Allambi'\n        WHEN f.FacilityName LIKE '%Cottage%Grove%' THEN 'Cottage Grove'\n        WHEN f.FacilityName LIKE '%Evanston%Park%' THEN 'Evanston Park'\n        WHEN f.FacilityName LIKE '%Goodwood%' THEN 'Goodwood'\n        WHEN f.FacilityName LIKE '%Hope%Valley%' THEN 'Hope Valley'\n        WHEN f.FacilityName LIKE '%Oxford%' THEN 'Oxford'\n        WHEN f.FacilityName LIKE '%Sash%Ferguson%' THEN 'Sash Ferguson'\n        WHEN f.FacilityName LIKE '%Seaford%' THEN 'Seaford'\n        WHEN f.FacilityName LIKE '%South%Park%' THEN 'South Park'\n        WHEN f.FacilityName LIKE '%Lodge%' THEN 'The Lodge'\n        WHEN f.FacilityName LIKE '%Village%' THEN 'The Village'\n        WHEN f.FacilityName LIKE '%Trowbridge%House%' THEN 'Trowbridge House'\n        ELSE NULL\n    END AS [Facility],\n    CASE\n        WHEN f.FacilityName LIKE '%Acacia Court%' THEN 'ACC'\n        WHEN f.FacilityName LIKE '%Allambi%' THEN 'ALL'\n        WHEN f.FacilityName LIKE '%Cottage%Grove%' THEN 'CGV'\n        WHEN f.FacilityName LIKE '%Evanston%Park%' THEN 'EVP'\n        WHEN f.FacilityName LIKE '%Goodwood%' THEN 'GWD'\n        WHEN f.FacilityName LIKE '%Hope%Valley%' THEN 'HVY'\n        WHEN f.FacilityName LIKE '%Oxford%' THEN 'OXF'\n        WHEN f.FacilityName LIKE '%Sash%Ferguson%' THEN 'SAF'\n        WHEN f.FacilityName LIKE '%Seaford%' THEN 'SFD'\n        WHEN f.FacilityName LIKE '%South%Park%' THEN 'MIN'\n        WHEN f.FacilityName LIKE '%Lodge%' THEN 'LDG'\n        WHEN f.FacilityName LIKE '%Village%' THEN 'VIL'\n        WHEN f.FacilityName LIKE '%Trowbridge%House%' THEN 'TRW'\n        ELSE NULL\n    END AS [FacilityAbbrev],\n    COUNT(b.ID) AS [NoOfBeds]\nFROM\n    OPENROWSET(\n        BULK 'https://devingesttraining001.dfs.core.windows.net/synapse001aq/DIMFacility/dbo.Facility.parquet',\n        FORMAT = 'PARQUET'\n    ) AS f\n    LEFT JOIN OPENROWSET(\n        BULK 'https://devingesttraining001.dfs.core.windows.net/synapse001aq/DIMFacility/dbo.Wings.parquet',\n        FORMAT = 'PARQUET'\n    ) AS w ON f.ID = w.FacilityID\n    LEFT JOIN OPENROWSET(\n        BULK 'https://devingesttraining001.dfs.core.windows.net/synapse001aq/DIMFacility/dbo.Rooms.parquet',\n        FORMAT = 'PARQUET'\n    ) AS r ON r.WingsID = w.ID\n    LEFT JOIN OPENROWSET(\n        BULK 'https://devingesttraining001.dfs.core.windows.net/synapse001aq/DIMFacility/dbo.Beds.parquet',\n        FORMAT = 'PARQUET'\n    ) AS b ON b.RoomsID = r.ID\nGROUP BY\n    f.FacilityCode,\n    f.ID,\n    f.FacilityName,\n    CASE\n        WHEN f.FacilityName LIKE '%Acacia Court%' THEN 'Acacia Court'\n        WHEN f.FacilityName LIKE '%Allambi%' THEN 'Allambi'\n        WHEN f.FacilityName LIKE '%Cottage%Grove%' THEN 'Cottage Grove'\n        WHEN f.FacilityName LIKE '%Evanston%Park%' THEN 'Evanston Park'\n        WHEN f.FacilityName LIKE '%Goodwood%' THEN 'Goodwood'\n        WHEN f.FacilityName LIKE '%Hope%Valley%' THEN 'Hope Valley'\n        WHEN f.FacilityName LIKE '%Oxford%' THEN 'Oxford'\n        WHEN f.FacilityName LIKE '%Sash%Ferguson%' THEN 'Sash Ferguson'\n        WHEN f.FacilityName LIKE '%Seaford%' THEN 'Seaford'\n        WHEN f.FacilityName LIKE '%South%Park%' THEN 'South Park'\n        WHEN f.FacilityName LIKE '%Lodge%' THEN 'The Lodge'\n        WHEN f.FacilityName LIKE '%Village%' THEN 'The Village'\n        WHEN f.FacilityName LIKE '%Trowbridge%House%' THEN 'Trowbridge House'\n        ELSE NULL\n    END,\n    CASE\n        WHEN f.FacilityName LIKE '%Acacia Court%' THEN 'ACC'\n        WHEN f.FacilityName LIKE '%Allambi%' THEN 'ALL'\n        WHEN f.FacilityName LIKE '%Cottage%Grove%' THEN 'CGV'\n        WHEN f.FacilityName LIKE '%Evanston%Park%' THEN 'EVP'\n        WHEN f.FacilityName LIKE '%Goodwood%' THEN 'GWD'\n        WHEN f.FacilityName LIKE '%Hope%Valley%' THEN 'HVY'\n        WHEN f.FacilityName LIKE '%Oxford%' THEN 'OXF'\n        WHEN f.FacilityName LIKE '%Sash%Ferguson%' THEN 'SAF'\n        WHEN f.FacilityName LIKE '%Seaford%' THEN 'SFD'\n        WHEN f.FacilityName LIKE '%South%Park%' THEN 'MIN'\n        WHEN f.FacilityName LIKE '%Lodge%' THEN 'LDG'\n        WHEN f.FacilityName LIKE '%Village%' THEN 'VIL'\n        WHEN f.FacilityName LIKE '%Trowbridge%House%' THEN 'TRW'\n        ELSE NULL\n    END;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}